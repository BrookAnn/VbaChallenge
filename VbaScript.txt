Sub VbaChallenge():
For Each ws In Worksheets
'declaring variables
Dim Ticker As String
Dim yearlychange As Double
Dim percentchange As Double
Dim totalstockvalue As Double
Dim row As Integer
'Dim i As Integer
'initializing variables
row = 2
'i = 2
totalstockvalue = 0
openprice = ws.Cells(2, 3).Value
'MsgBox (openprice)
'adding column headers for output table
ws.Cells(1, 9).Value = "Ticker"
ws.Cells(1, 10).Value = "Yearly change"
ws.Cells(1, 11).Value = "Percent Changed"
ws.Cells(1, 12).Value = "Total Stock Volume"
lastRow = ws.Cells(Rows.Count, 1).End(xlUp).row
'Starting for loop
For i = 2 To lastRow
    If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
      Ticker = ws.Cells(i, 1).Value
      totalstockvalue = totalstockvalue + ws.Cells(i, 7).Value
      yearlychange = ws.Cells(i, 6).Value - openprice
      If openprice = 0 Then
      percentchange = 0
      Else
      percentchange = yearlychange / openprice
       End If
        If yearlychange < 0 Then
    'Setting color as Red
            ws.Cells(row, 10).integer.ColorIndex = 3
        Else
             ws.Cells(row, 10).integer.ColorIndex = 4
        End If
    'Printing the results on the output table
     ws.Cells(row, 9).Value = Ticker
     ws.Cells(row, 10).Value = yearlychange
     ws.Cells(row, 11).Value = percentchange
     ws.Cells(row, 12).Value = totalstockvalue
    'Incrimenting row for output table
      row = row + 1
        totalstockvalue = 0
        openprice = ws.Cells(i + 1, 3).Value
    Else
    totalstockvalue = totalstockvalue + ws.Cells(i, 7).Value
    yearlychange = ws.Cells(i, 6).Value - openprice
    End If
    Next i
Next ws
End Sub

